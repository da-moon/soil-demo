
[Unit]
Requires=network-online.target
After=network-online.target
{% for item in hcl_config_filelist  %}
ConditionFileNotEmpty={{ item }}
{% if not loop.last %}
{% endif %}
{% endfor %}
StartLimitIntervalSec=60
StartLimitBurst=3

[Service]
User=soil
Group=soil
ExecStart=/usr/local/bin/soil agent --id "{{ ansible_hostname }}" \
    --config="{{ soil_config_path }}" \
    --config="{{ soil_pods_path }}"

# BEGIN ANSIBLE MANAGED BLOCK
# END ANSIBLE MANAGED BLOCK

ExecReload=/bin/kill --signal HUP $MAINPID
KillMode=process
KillSignal=SIGINT
Restart=on-failure
RestartSec=5
TimeoutStopSec=30
StartLimitInterval=60
StartLimitBurst=3
LimitNOFILE=65536
LimitMEMLOCK=infinity

[Install]
WantedBy=multi-user.target
